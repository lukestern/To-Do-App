env:
  global:
  - DOCKER_USER: toastyluke
  - HEROKU_APP: todo-las
  - secure: Rcbwut+8Sabx3d+lwBeTG7AfceyPgQhy0htfHCG3c14JpFbDhDDGAmTzSZQbb1jAsS4jbML5p1bY2fdZpyFjuF6xuGlfR0wxHIlJB757u9yQe/QNlcJd8oF7vBC/ML1WEeGLiUp6X4sfX6B85RxGMaQQs1XKZ3dHanMmTgAzk07FRPd9eeIKw8yT8HoaoXFBWYAt+EseKYgdXMU2xo26pa9hKrpEhLutRkPbIc34NpKwIHuLkjSBvza9FXIsY4lhGtZF77a/Zvu0jQDX+EmvSlynnRLpSgSU5Cw59/XP11gfDNNaLBxzqbZAimY7ZbwMXNiarhdmRUDlA8gh9bwqWkYASppoBXfb1QwgUlbMNZLlPhtA0i7Hk292+nhGLCvD5O/tsAPP/Q7E78iztSs6WNaD8/inBmyu4l4WzPtybFUbWtUn0SCoCdgtNOvbwYvaat36g+uWAp/Ru1zh9vDYf3tVEYWi9i2Z0R5mg10rpVoIzPYoYi/J+7Tt1zahLs98iIN2tfSbn4fYVOHwCivlHEJus9vFuQEMpz4sgLaFLSKaExal1RaQJXy2S9jo3U1SeAG+njA7TFBiISTCBgf3SsPd9qXoJdMcEvlCA6gHQzvcMLmBMUOLGwngz0ybdEIao5Ha1WHeiu0Mo+0lp0QKSaS2UCItKCTYB0XMQeYWwys=
  - secure: fvad6wdAZsbG0YgYSLZDc29sTYhG/4/IpYuSYGcxIdGgvm9nq8I2Lu3UBPzeyLIMGMGG9GyTwIGZ2sfG97xxJij6jKE18y2ox30EmbS3G/4GWLymcB/soYXwlnkaVvVKS64bQ1S1bxDugSBMP7tUJdMer51Tugy8r36+TUFeIPXQWlcfGgQKvH+ca9fXaPGzZhwNGYGHMieErLh9Aa8dRmKg5fQTaw9ViFamojORJV2HSQNK7pchvCYmsYYlcWeDTvyimJkU/V03ACJEuM1IaNfM3jR6NUYxqrkaNHj19Xg34wb7XlFJvGb+3lNYC44UTPI9f7smvLiY9SSw2UipEy9WnoWqV4Ce7XcDUT6P75BxosNQz0BwC45Uyeouk5Wpyc0mPlC35mpVA7NJjLBsuiSe5JTw9cXZCQzm2Us+hh6nd3a3eZAzgI/Cyz0DHl3B/jIl7YatjEw3yG06ZQHM3Dkc9EMTkFJxFBaZpcjeV2iZR60lb7VpRXi+e3VaCupimAwaH3q/Bs9vomuzTiG3tG+BdZa+W1br5tbaTXPUEl2VWOGRUL8A9IGOyXqKP9KfKYTDocc0rMaKFv8VDuqCjAcHVK7o5z7fXba8352JzimKS6nYjmSFhrT4m+yYEKJ9MwiFCY2Zpql577CMufnQMAlDjVkWZHyj7W/lyLbprz8=
  - secure: EdGSWspwhYPKbPrAOr2I+n8TJVwH4QZOXyZRpuMW2X08LRQQSXuk7+QhDFsU5w2+WtYHjl30yyWwjcaysvfJGM5eG70dRXEnq8PGwKdVdxN7LzlLSVrKhpcdC7RWP6PQ5NeM02RI5kaTziR8idrSlS1l/4n2VPXJKkN/G7BKqK8V0Ye+Fkkozg3JIU3uwSr78lSdf5jgur2qhXmCEuLw88a4wlickg7RXwBZRjikWWl7HDH8UkQ8q157mHjGbozA2PQtLaly/N27/H3JGq8wr+ls1L5YyYXXOkhyWRqIBedDKvR1FiWC+Jg2eY+S8i13K4nqm6AZ+K4EdQ3Xo72TMaKaFSpEwR/5LbXp9XLq0xxq0869z+T6h6NfrrFx6RtcolURfdiVS08u6i0FRHPA0DV+T6x2f7x64QUWwKcHqTWn2kEQZLRMTUF5c8CpJwXrfcQZNTYUgwqCfFjBnyAHFhjP2PhCUS65xI8e9TT2BV4NkgahL2OQS5QEKQ825CF/4htvHFBjfEwNt8M/onQATS2aXKraNCQLlDAldDa2X/T9YhRUHVNvlrs5I4Hpr/YESEfqZOOETjvsgs7bJhE5SscydSuGzKTW27s1SF/4r3iZcPZ6TEUvVwQBmlj6xR0YXNT6YfQaTzgHVXR/3IXhDuavhBv/npKcdqIsSvZ9fHw=
  - secure: MGsnaFR4qAXXvB674TyM3RnAeYWeEy4MRZShpXthTO1G7c2oV3Bt4lOjnhiLrM+PRyf9kZu8ITuJcwYukRsA+/es1z9y+iUSY7ROtNGJEOkBCHuC/ORLcGt+hOTeoYKsj3DWAl0lDLH4hcRptlZ5in9470KJDagxQhDe5Zh9uxi1veyIZDt+TsuDKi1J9BqmKpyfz2Hc14PRAzcZndPM6ZHacaMEw+8SGfN11YZj4RZdkBqu6RX7n5IHw1jv0BaQxs8MZy3IaaepQt1whU6DFdLMnlIIp5XfeXuFzVSvjYV2bQzNG6J58w/D4LsZz0NadyU5e3+2Ec+gBWEn6jR326aPkNtw+QVv/YX6he7Mixy2L44OaDcQo1+/kuE4elQW4jBgXke9Vb2UPRtQNfuPfGUJt84GLN6rg4YfNrtSAA7PdUxiXh8nTuuAxu/zVGi970BMUVhpX2sJFDSr+uv09huSYrlV2oUZQ8S4sxnPkOtUF8djzXhXB7Nj/GkYejVa4DR6Fx9gEhYFdkhidXJq4Ob5rmlGquafS5K2xQSWFq3DpyCtBZlrjxZJFpYnPtjJE9PJ1eN0UdcoMThN+3ittHZ8CseMM9iwCcNKq0pKmjEaTUATJFHHMp5wlto70+WrvnF0Dub15yJsb73YXoROsu5yO4th+YVBrHUsP3dML2o=
  - secure: FKeddpXx8/2shIsUcSnRqmf8LAvdC0+zGyaXM2uj7V5t4pQ4ypHceUihhD9zwRrX1ph+4piW2qxJyaNzx1i2KkXtkqby9HCb2wordbYlkxKIT2ZkdrVE3zb0+Z8CTlc8DFhDPU+zxRRs5YbDQbwY0GKiPU82QI+KZGI55WrD7x24xxeGK3rlvw8YxAyXxaeS6hJXgH6Gumnzu0jEiFEtnKHCLV1vz4maTYXaZ911rMm2Hl06LYLhX+yZqsyMtq/XF/lGTymbRG0Sa5QSelgkBm1Jj3tA/UzakzizJIgR1mOqq6eA1M6pIwl9PaVGmbEvfYqsdCOpkYYHDjmGXQW7JprINs5unjACd/4qy8MKzUfFXEzd7yzKS5pwFh0oHCytMYwRcHkmNodYM+/cEc9JBgcc7bnm6QWLg+M+LsOK0ZHsy8R74uZdv9Q+V1D6xjYbYuBfw7UJw/GpseDbpVX3piDlfw9y7s+kfgLXikyXjyn2QWkiL4/w1URo8OswO8q3F5XrRO3d+XjfncXYzfs2lpt50bp2o8E5ouFOSsBATtTHpO27pyo1Torm9s7tX8rZp6hdc3i33hFVF6xkY3ir7rvwdyJ3CKD58oHOphFBLRSaJ/oHGdvepkxUzQtVpds3GShQgcYqoXe51ZxRTLqXdckvU/jJ7YOWKYO7EPDMdM8=
  - secure: sKcDni5loobthkFMppf//Y3bNsMyXqFB7SJCkOaeAUV4dugij9ZKY4bggzq6fCpDTZb+AY1wWDJr3iIr4+mGAnebWMz9qD8IGOTuVFEn6FpjNuqJRyQxb5VedLd33eFsi9Cg58mI9KKQ32Inqhx4sEdNL14LtlkrPsfNPPCTmfUCwSfVVCUyUJzRk4PePNIz4Y8DP8y4HoN0Il+64fw8Dd1De+5BLUPotTDEL7kmgiWvYx1HNbPr0oAlhTATWXrp6aUxaP0wt7Q14qGFRQWLC1kPkiDHcU7CLe3rhcKVVsDj/gLbds1HPQGiuRocKqfWLQeohi0lf8Wz4f5oHnc/4zD3sm8U8aliwTQ+3zVSzh0zvufQGfDGGdMW8MfOUs2GbwJXw7jkMtyfXULd7UpmXEx+7mPjxFzZfowoob3AoUWppjrs9ABrNnmRLAmaEpgOBj5ZC4rew8iHKrr0rX6R5qBV058wYBekFGFYpUOThpzy3v8hBTuODY7MHOM8/0Pl9aQ8i1MVHeBICem06wxb0FCoSDs+2jHugl7TmcFjW+TltQlay38RaJFehoDPs/8RA/xaQ3RyWsBVARoFSyHeFRf/PE552nmlutU6q+rMTlzmjUgfij/D5roIoDnOWvam++OoEeuN8pEmYYmsY+i5ovwmIVL+Yj0rRXFFtelWGQw=
services:
- docker
script:
- docker build --target test --tag $DOCKER_USER/todo-app:test .
- docker run --env-file .env.test $DOCKER_USER/todo-app:test tests
- docker run -e DB_USER -e DB_USER_PASSWORD -e CLUSTER_URL -e DB_NAME $DOCKER_USER/todo-app:test
  tests_end_to_end
after_success:
- echo $DOCKER_PASSWD | docker login --username $DOCKER_USER --password-stdin
- docker pull $DOCKER_USER/todo-app:latest
- docker build --cache-from $DOCKER_USER/todo-app:latest --target production --tag
  $DOCKER_USER/todo-app:latest .
- docker tag $DOCKER_USER/todo-app:latest $DOCKER_USER/todo-app:$TRAVIS_COMMIT
- docker push $DOCKER_USER/todo-app:latest
- docker push $DOCKER_USER/todo-app:$TRAVIS_COMMIT
- docker tag $DOCKER_USER/todo_app registry.heroku.com/$HEROKU_APP/web
deploy:
  provider: heroku
  api_key:
    secure: gHIDdLrI4zE6xVLWF+dpevj6wixO3YrWVo3T22VKQU/Qk48+erowXL1mmP658X0+GI5uLKDpvkTs97so+28+yGl0NIQwC+1FImmnqVoKrQhHoJVKjCGSetCZp1c71E/c0Tpmmd6ApeuPDs6UKg7rnNLhNpTH7INjch3OtqymxS8qS3mFULehF936PpLyzlsWc6aO0KpUrudXgTFFUDA4FAkndpI22bA2AiaPAZkBvIpHJ+qZnLrpH7/DkwlCPPDIttm9yO0sFymR1s/55z0A/W1ZLXfMCRUobL0MaCAjTJ8/0YQvnK583BsQXSFUPwQGVYI5uUIm9/4Zoprgx7ZN27bEHIjEB6Meq3PUUCn05zbC1npfKa6TC0+xgx8Ij0lhlZko6tnvx42kQvGctMUM5SCW+m5OpKiVZ8rpqdEjUg6iNFGiciyZVPpSckKWTg30GwwDbrsU2hWfbCZxmXSgx9kVI5fDJ/uH0Jeh+HpcffqBUgg47rViaZmbwG1vMmc2c11k+o4xrVeoSei7IYVSC/NUN4fasqix2dv/q2KGPwUQdNMqST8zPkIpnaamCkAx3IB/nQ+gFcfdzwCG193NIsDej3fAJ00BXbRgg4nqFzSZqZUSJWEL/33QtWBjc3hoBL7xasxDXqjzAJAEM7qrPgiGikO44LGNMPPJOG2Agps=
  app: todo-las
  on:
    repo: lukestern/To-Do-App
    branch: Module-9-Exercise
  skip_cleanup: 'true'
notifications:
  slack:
    secure: aK5ycpRhw4sf4a6M/graRjgAXK5UkasRjErYiyPGP405OjhFoGsrpU5Xi689l6TPMs0pq9R0U20f67jn0JrR2z9dXx+JSjZKFWiZGlhmwPsMJ32kNDr7Lr3GozFlbDrzAtQd3yorVenvUPiZqBASY5TbMXPHDI/vRgUwFAa37nT/j/mFvuk9cr2QX8NUXt4cUxqfGLkJJiniw0IkwKyV4P8ub+uahIpUjW+GmQhogO0Pplv4/L9y7rz7x7u+RoCPRX11t/YPgDd3RA16dO23w0hUa3EZ4HjGzTe44NxlatQQ6MHrFUQh4/t74rl+grbPD/5ZacTT6+A/AITIPh96IujgpKNuWmwNCgNMKDyHWJEwkfbWI3UO40JFUnYLvlX0j8lfMwqqB2q/+SlwINbVJK+HQbNlAm5guVsyrKcl7fEvg6w51WQYZ1ishB/1oMUkC0FEW5raHS7m+JnaRAQ2FMsUeygsUA434KUjGU8FF+FoaGYXhogCRY8gOh/aJaUwOh59x89Y4ZPYSLt6UYCGgGE6ESDyqmLqGmecsRzvhijSVBl8BQbrpbXuWl3IB3YBZKx2PiANTu0edNBt2TZ5bW2SBQr7jvbfqX+1riSX/OMgWGG0T2yK8Lpf4ytQz4HLalLUh96K/5yR11WZL49k7JVfFd8XnX0oB5okQF4Kmmw=
    on_success: change
    on_failure: always
